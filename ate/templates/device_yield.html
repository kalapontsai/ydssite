{% load static %}
<!DOCTYPE html>
<html>
<head>
    <title>單一產品良率</title>
    <link rel="stylesheet" href="/static/css/style_l.css">
    <script type="text/javascript" src="{% static 'js/jquery-1.11.0.min.js' %}"></script>
    <script type="text/javascript" src="{% static 'js/highcharts/highcharts.js' %}"></script>
   <script type="text/javascript" src="{% static 'js/highcharts/modules/exporting.js' %}"></script>
</head>
<body>
<div align="center"><h2><a href='./'>回主畫面</a></h2></div>
<form name="ate_func" action="" method="post">
{% csrf_token %}
<table class="t1">
	<tr>
		<td><div align="center">
				<select  name="device" required="required" class="form-control">
					{% for i in devices %}
                  {% if i == device %}
					    <option selected="selected">{{i}}</option>
                   {% else %}
                   <option>{{i}}</option>
                  {% endif %}
					{% endfor %}
				</select>
			</div>
		</td>
		<td><div align="center"><input type="text" name="total_gt" placeholder="納入計算的最小批量(1000)" class="form-control" width="80"></div></td>
		<td><div><input type="image" src="/static/images/button_start.png" border="0" alt="重新篩選" title=" 重新篩選" width="80"></div></td>
	<tr>
</table>
</form>

<div align="center"><h3>機種名稱:{{ device }} </h3></div>
<table class="t1">
	<tr>
      <th width="150">日期</th>
		<th >批號</th>
		<th width="60">總數</th>
		<th width="60">良品</th>
		<th width="60">良率</th>
	</tr>
	{% for i in arr %}
	<tr>
      <td><div align="center">{{i.date}}</div></td>
		<td><div align="center">{{i.lotname}}</div></td>
		<td><div align="center">{{i.total}}</div></td>
		<td><div align="center">{{i.good}}</div></td>
		<td><div align="center">{{i.yield_cal}}</div></td>
	</tr>
	{% endfor %}
</table>
<br>
<div id="container" style="width: 800px; height: 400px; margin: 0 auto">
<script type="text/javascript">
$(document).ready(function() {
   var title = {
      text: '每批 總數/良品/良率 曲線圖'
   };
   var subtitle = {
      text: 'Source: ATE tester'
   };
   var xAxis = {
      title: {
         text: '批號'
      },
      categories: [
         {% for i in arr %}
            '{{i.lotname}}',
         {% endfor %}
      ]
   };
   var yAxis = [{ //Y1
      title: {
         text: '數量',
         style: {
               color: Highcharts.getOptions().colors[0]
            }
      }
   },
   { //Y2
      title: {
         text: '良率',
         style: {
               color: Highcharts.getOptions().colors[1]
            }
      },
      opposite: true
   }];



   var tooltip = {
      valueSuffix: ' pcs'
   }

   var legend = {
      layout: 'vertical',
      align: 'right',
      verticalAlign: 'middle',
      borderWidth: 0
   };

   var series =  [
      {
         name: 'Total',
         yAxis: 0,
         data: [
                  {% for i in arr %}
                     {{i.total}},
                  {% endfor %}
         ],
         tooltip: {
                valueSuffix: ' pcs'
            }
      }, 
      {
         name: 'Pass',
         yAxis: 0,
         data: [
                  {% for i in arr %}
                     {{i.good}},
                  {% endfor %}
         ],
         tooltip: {
                valueSuffix: ' pcs'
            }
      },
      {
         name: 'Yield',
         yAxis: 1,
         data: [
                 {% for i in arr %}
                     {{i.yield_cal}},
                  {% endfor %}
         ],
         tooltip: {
                valueSuffix: ' %'
            }
      }
   ];

   var json = {};

   json.title = title;
   json.subtitle = subtitle;
   json.xAxis = xAxis;
   json.yAxis = yAxis;
   json.tooltip = tooltip;
   json.legend = legend;
   json.series = series;

   $('#container').highcharts(json);
});
</script>
</div>
</body>
</html>